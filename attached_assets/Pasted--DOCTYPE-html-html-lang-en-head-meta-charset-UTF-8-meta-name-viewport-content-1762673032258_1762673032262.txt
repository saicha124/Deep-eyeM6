<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Digest - https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-gradient-start: #667eea;
            --bg-gradient-end: #764ba2;
            --card-bg: #ffffff;
            --text-primary: #333333;
            --text-secondary: #7f8c8d;
            --border-color: #e0e0e0;
            --shadow: 0 5px 15px rgba(0,0,0,0.1);
            --shadow-hover: 0 8px 30px rgba(0,0,0,0.25);
            --accent-color: #667eea;
            --code-bg: #2d2d2d;
            --code-text: #f8f8f2;
        }
        
        [data-theme="dark"] {
            --bg-gradient-start: #1a1a1a;
            --bg-gradient-end: #2d2d2d;
            --card-bg: #2d2d2d;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --border-color: #404040;
            --shadow: 0 5px 15px rgba(0,0,0,0.3);
            --shadow-hover: 0 8px 30px rgba(0,0,0,0.4);
            --code-bg: #1e1e1e;
            --code-text: #d4d4d4;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .controls-bar {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }
        
        .filter-panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: none;
        }
        
        .filter-panel.active {
            display: block;
        }
        
        .filter-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: bold;
        }
        
        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 14px;
        }
        
        .header {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .header-text h1 {
            font-size: 2.5em;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .header-text p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }
        
        .logo {
            max-width: 150px;
            height: auto;
        }
        
        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .view-btn {
            padding: 12px 25px;
            border: 2px solid var(--accent-color);
            background: transparent;
            color: var(--text-primary);
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .view-btn.active {
            background: var(--accent-color);
            color: white;
        }
        
        .timeline-view {
            display: none;
            position: relative;
            padding-left: 50px;
        }
        
        .timeline-view.active {
            display: block;
        }
        
        .timeline-line {
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--accent-color);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
        }
        
        .timeline-marker {
            position: absolute;
            left: -42px;
            top: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 4px solid var(--accent-color);
            background: var(--card-bg);
        }
        
        .timeline-item.critical .timeline-marker {
            border-color: #8B0000;
            background: #8B0000;
        }
        
        .timeline-item.high .timeline-marker {
            border-color: #FF4500;
            background: #FF4500;
        }
        
        .timeline-item.medium .timeline-marker {
            border-color: #FFA500;
            background: #FFA500;
        }
        
        .timeline-item.low .timeline-marker {
            border-color: #FFD700;
            background: #FFD700;
        }
        
        .severity-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .severity-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        
        .severity-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .severity-card h2 {
            font-size: 3em;
            margin-bottom: 5px;
        }
        
        .severity-card p {
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
        }
        
        .severity-critical { border-left: 6px solid #8B0000; }
        .severity-critical h2 { color: #8B0000; }
        
        .severity-high { border-left: 6px solid #FF4500; }
        .severity-high h2 { color: #FF4500; }
        
        .severity-medium { border-left: 6px solid #FFA500; }
        .severity-medium h2 { color: #FFA500; }
        
        .severity-low { border-left: 6px solid #FFD700; }
        .severity-low h2 { color: #FFD700; }
        
        .grid-view {
            display: grid;
        }
        
        .grid-view.active {
            display: grid;
        }
        
        .vuln-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border-left: 8px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .vuln-card:hover {
            box-shadow: var(--shadow-hover);
        }
        
        .vuln-card.critical { border-left-color: #8B0000; }
        .vuln-card.high { border-left-color: #FF4500; }
        .vuln-card.medium { border-left-color: #FFA500; }
        .vuln-card.low { border-left-color: #FFD700; }
        
        .vuln-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .vuln-title {
            font-size: 1.8em;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .severity-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
            text-transform: uppercase;
        }
        
        .badge-critical { background: #8B0000; }
        .badge-high { background: #FF4500; }
        .badge-medium { background: #FFA500; }
        .badge-low { background: #FFD700; color: #333; }
        
        .vuln-section {
            margin: 20px 0;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            border-left: 4px solid var(--accent-color);
        }
        
        .vuln-section h3 {
            color: var(--accent-color);
            margin-bottom: 12px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .vuln-section p {
            color: var(--text-primary);
        }
        
        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.5;
            position: relative;
            margin: 10px 0;
        }
        
        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--code-text);
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }
        
        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .payload-source {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .payload-source p {
            margin: 5px 0;
            color: #1976d2;
        }
        
        .payload-source strong {
            color: #0d47a1;
        }
        
        .meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .meta-item {
            background: var(--card-bg);
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid var(--accent-color);
        }
        
        .meta-item strong {
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
        }
        
        .meta-item span {
            color: var(--text-primary);
        }
        
        .http-section {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .http-section h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .detection-source {
            background: #d4edda;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .detection-source p {
            margin: 5px 0;
            color: #155724;
        }
        
        .remediation-box {
            background: #f0f8ff;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .remediation-box h3 {
            color: #4a90e2;
            margin-bottom: 15px;
        }
        
        .remediation-box ol {
            margin-left: 20px;
            line-height: 2;
        }
        
        .remediation-box li {
            margin: 10px 0;
        }
        
        .vulnerable-code-block {
            background: #fff5f5;
            border: 2px solid #e53e3e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
        }
        
        .vulnerable-code-block h4 {
            color: #c53030;
            margin-bottom: 10px;
        }
        
        .vulnerable-code-block .code-block {
            background: #fed7d7;
            border: 1px solid #fc8181;
            color: #000000;
        }
        
        .vulnerable-code-block .code-block pre {
            color: #000000;
        }
        
        .solution-code-block {
            background: #f0fff4;
            border: 2px solid #38a169;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
        }
        
        .solution-code-block h4 {
            color: #22543d;
            margin-bottom: 10px;
        }
        
        .solution-code-block .code-block {
            background: #c6f6d5;
            border: 1px solid #68d391;
            color: #000000;
        }
        
        .solution-code-block .code-block pre {
            color: #000000;
        }
        
        .code-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .code-comparison {
                grid-template-columns: 1fr;
            }
        }
        
        .timestamp {
            color: #7f8c8d;
            font-size: 0.9em;
            font-style: italic;
        }
        
        .footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 40px;
        }
        
        .footer p {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="controls-bar">
        <button class="control-btn" onclick="toggleTheme()">üåô Dark Mode</button>
        <button class="control-btn" onclick="toggleFilters()">üîç Filters</button>
        <button class="control-btn" onclick="exportToJSON()">üì• Export JSON</button>
        <button class="control-btn" onclick="exportToCSV()">üìä Export CSV</button>
        <button class="control-btn" onclick="window.print()">üñ®Ô∏è Print</button>
    </div>
    
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-text">
                    <h1>üìã Vulnerability Digest</h1>
                    <p><strong>Target:</strong> https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/</p>
                    <p><strong>Generated:</strong> 2025-11-06 08:34:34</p>
                </div>
                <div class="header-logo">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgMTIwIiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjEyMCI+CiAgPCEtLSBCYWNrZ3JvdW5kIC0tPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkMSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIAogIDwhLS0gU2hpZWxkIEljb24gLS0+CiAgPGcgaWQ9InNoaWVsZCI+CiAgICA8cGF0aCBkPSJNIDMwIDIwIEwgNTAgMTUgTCA3MCAyMCBMIDcwIDUwIFEgNzAgNzAgNTAgODAgUSAzMCA3MCAzMCA1MCBaIiAKICAgICAgICAgIGZpbGw9InVybCgjZ3JhZDEpIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgPHBhdGggZD0iTSA0NSA0MCBMIDQ4IDUwIEwgNjAgMzUiIAogICAgICAgICAgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgogIDwvZz4KICAKICA8IS0tIENFUklTVCBUZXh0IC0tPgogIDx0ZXh0IHg9Ijg1IiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjM2IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iIzMzMyI+CiAgICBDRVJJU1QKICA8L3RleHQ+CiAgCiAgPCEtLSBTdWJ0aXRsZSAtLT4KICA8dGV4dCB4PSI4NSIgeT0iNzAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZmlsbD0iIzY2NiI+CiAgICBDZW50cmUgZGUgUmVjaGVyY2hlIHN1ciBsJ0luZm9ybWF0aW9uIFNjaWVudGlmaXF1ZSBldCBUZWNobmlxdWUKICA8L3RleHQ+CiAgCiAgPCEtLSBTZWN1cml0eSBFbGVtZW50cyAtLT4KICA8Y2lyY2xlIGN4PSIzNjAiIGN5PSIzMCIgcj0iOCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNjY3ZWVhIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8Y2lyY2xlIGN4PSIzNjAiIGN5PSIzMCIgcj0iNCIgZmlsbD0iIzY2N2VlYSIvPgogIAogIDxwYXRoIGQ9Ik0gMzUwIDYwIEwgMzYwIDUwIEwgMzcwIDYwIiBmaWxsPSJub25lIiBzdHJva2U9IiM2NjdlZWEiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo=" alt="CERIST" class="logo">
                </div>
            </div>
        </div>
        
        <div class="filter-panel" id="filterPanel">
            <h2 style="color: var(--text-primary); margin-bottom: 20px;">üîç Advanced Filters</h2>
            <div class="filter-controls">
                <div class="filter-group">
                    <label for="severityFilter">Severity Level</label>
                    <select id="severityFilter" onchange="applyFilters()">
                        <option value="all">All Severities</option>
                        <option value="critical">Critical Only</option>
                        <option value="high">High Only</option>
                        <option value="medium">Medium Only</option>
                        <option value="low">Low Only</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="searchBox">Search Vulnerabilities</label>
                    <input type="text" id="searchBox" placeholder="Search by type, URL, or description..." oninput="applyFilters()">
                </div>
                <div class="filter-group">
                    <label for="sortBy">Sort By</label>
                    <select id="sortBy" onchange="applySorting()">
                        <option value="severity">Severity (High to Low)</option>
                        <option value="time">Discovery Time</option>
                        <option value="type">Vulnerability Type</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="severity-summary">
            <div class="severity-card severity-critical">
                <h2>0</h2>
                <p>Critical</p>
            </div>
            <div class="severity-card severity-high">
                <h2>0</h2>
                <p>High</p>
            </div>
            <div class="severity-card severity-medium">
                <h2>88</h2>
                <p>Medium</p>
            </div>
            <div class="severity-card severity-low">
                <h2>29</h2>
                <p>Low</p>
            </div>
        </div>
        
        <div class="view-toggle">
            <button class="view-btn active" onclick="switchView('grid')">üìä Grid View</button>
            <button class="view-btn" onclick="switchView('timeline')">üìÖ Timeline View</button>
        </div>
        
        
        <div class="grid-view active" id="gridView">
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:33">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:33</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.404s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:33">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:33</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.404s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:33">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:33</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.404s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.410s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.410s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.410s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:40">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:40</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:40">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:40</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:40">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:40</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.400s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>completedListeners = [];

(function () {
    let labHeaderWebSocket = undefined;
    function openWebSocket() {
        return new Promise(res =&gt; {
            if (labHeaderWebSocket) {
                res(labHeaderWebSocket);
                return;
            }

            let newWebSocket = new WebSocket(location.origin.replace(&#34;http&#34;, &#34;ws&#34;) + &#34;/academyLabHeader&#34;);

            newWebSocket.onopen = function (evt) {
                res(newWebSocket);
            };

           ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.400s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>completedListeners = [];

(function () {
    let labHeaderWebSocket = undefined;
    function openWebSocket() {
        return new Promise(res =&gt; {
            if (labHeaderWebSocket) {
                res(labHeaderWebSocket);
                return;
            }

            let newWebSocket = new WebSocket(location.origin.replace(&#34;http&#34;, &#34;ws&#34;) + &#34;/academyLabHeader&#34;);

            newWebSocket.onopen = function (evt) {
                res(newWebSocket);
            };

           ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.400s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>completedListeners = [];

(function () {
    let labHeaderWebSocket = undefined;
    function openWebSocket() {
        return new Promise(res =&gt; {
            if (labHeaderWebSocket) {
                res(labHeaderWebSocket);
                return;
            }

            let newWebSocket = new WebSocket(location.origin.replace(&#34;http&#34;, &#34;ws&#34;) + &#34;/academyLabHeader&#34;);

            newWebSocket.onopen = function (evt) {
                res(newWebSocket);
            };

           ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:46">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:46</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.425s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:46">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:46</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.425s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:46">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:46</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=4
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.425s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:51">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:51</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.403s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:51">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:51</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.403s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:51">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:51</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=17
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.403s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:52">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:52</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.416s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:52">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:52</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.416s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:52">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:52</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=18
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.416s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=5
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.405s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.405s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:57">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:57</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=9
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.405s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:58">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:58</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.412s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:58">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:58</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.412s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:58">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:58</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=6
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.412s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.487s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>(function () {
    var chatForm = document.getElementById(&#34;chatForm&#34;);
    var messageBox = document.getElementById(&#34;message-box&#34;);
    var webSocket = openWebSocket();

    messageBox.addEventListener(&#34;keydown&#34;, function (e) {
        if (e.key === &#34;Enter&#34; &amp;&amp; !e.shiftKey) {
            e.preventDefault();
            sendMessage(new FormData(chatForm));
            chatForm.reset();
        }
    });

    chatForm.addEventListener(&#34;submit&#34;, function (e) {
        e.preventDefault();
       ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.487s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>(function () {
    var chatForm = document.getElementById(&#34;chatForm&#34;);
    var messageBox = document.getElementById(&#34;message-box&#34;);
    var webSocket = openWebSocket();

    messageBox.addEventListener(&#34;keydown&#34;, function (e) {
        if (e.key === &#34;Enter&#34; &amp;&amp; !e.shiftKey) {
            e.preventDefault();
            sendMessage(new FormData(chatForm));
            chatForm.reset();
        }
    });

    chatForm.addEventListener(&#34;submit&#34;, function (e) {
        e.preventDefault();
       ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/js/chat.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.487s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>(function () {
    var chatForm = document.getElementById(&#34;chatForm&#34;);
    var messageBox = document.getElementById(&#34;message-box&#34;);
    var webSocket = openWebSocket();

    messageBox.addEventListener(&#34;keydown&#34;, function (e) {
        if (e.key === &#34;Enter&#34; &amp;&amp; !e.shiftKey) {
            e.preventDefault();
            sendMessage(new FormData(chatForm));
            chatForm.reset();
        }
    });

    chatForm.addEventListener(&#34;submit&#34;, function (e) {
        e.preventDefault();
       ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:03">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:03</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/forgot-password
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:04">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:04</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:04">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:04</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:04">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:04</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=15
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:05">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:05</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:05">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:05</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:05">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:05</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=11
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Cross-Site Request Forgery (CSRF)" data-timestamp="2025-11-06 08:34:34">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Cross-Site Request Forgery (CSRF)
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:34</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>Missing CSRF protection on forms</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Form found without CSRF token</p>
            </div>
            
            
            
            
            
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-3 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Review the vulnerability description and evidence</li>
                
                    <li>Consult OWASP guidelines for this vulnerability type</li>
                
                    <li>Implement proper input validation and output encoding</li>
                
                    <li>Apply security patches and updates</li>
                
                    <li>Conduct thorough testing after remediation</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 15px;">Code Example:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>Refer to security best practices for this vulnerability type</pre>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Top 10</li>
                
                    <li>https://owasp.org/www-project-top-ten/</li>
                
                </ul>
                
                
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:10">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:10</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.408s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:10">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:10</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.408s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:10">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:10</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/chat
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.408s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:11">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:11</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.418s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:11">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:11</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.418s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:11">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:11</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=14
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.418s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.406s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.406s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=1
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.406s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=2
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.415s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.415s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:16">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:16</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=8
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.415s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:17">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:17</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
            ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:17">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:17</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
            ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:17">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:17</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/openai/logs
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
            ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:22">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:22</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.417s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:22">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:22</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.417s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:22">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:22</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.417s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:23">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:23</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:23">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:23</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:23">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:23</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=10
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:24">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/my-account</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:24</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.810s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:24">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/my-account</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:24</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.810s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:24">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/my-account</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:24</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.810s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=7
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:29">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:29</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=19
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:34">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:34</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>MIME sniffing protection missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-Content-Type-Options</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.413s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - VULNERABLE
const express = require(&#39;express&#39;);
const app = express();

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // Missing X-Content-Type-Options header
    // Browser may MIME-sniff responses
});</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Express.js Application - SECURE
const express = require(&#39;express&#39;);
const helmet = require(&#39;helmet&#39;);
const app = express();

app.use(helmet.noSniff());

app.get(&#39;/&#39;, (req, res) =&gt; {
    res.send(&#39;&lt;h1&gt;Welcome&lt;/h1&gt;&#39;);
    // X-Content-Type-Options: nosniff set automatically
});</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:34">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:34</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>HSTS not enforced</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Strict-Transport-Security</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.413s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - VULNERABLE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # Missing HSTS header
    # Users may accidentally use HTTP
}</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Nginx Configuration - SECURE
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # HSTS enabled - Force HTTPS
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
}</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card medium" data-severity="medium" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:34:34">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-medium">MEDIUM</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:34:34</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>CSP not implemented</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: Content-Security-Policy</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=12
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.413s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - VULNERABLE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Missing CSP header
# Vulnerable to XSS attacks via inline scripts</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Django Application - SECURE
# settings.py
MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;csp.middleware.CSPMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
]

# Content Security Policy configured
CSP_DEFAULT_SRC = (&#34;&#39;self&#39;&#34;,)
CSP_SCRIPT_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)
CSP_STYLE_SRC = (&#34;&#39;self&#39;&#34;, &#34;&#39;unsafe-inline&#39;&#34;)</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:33">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:33</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/login
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.404s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labs.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div class=logo&gt;&lt;/div&gt;
 ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=16
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.407s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=3
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.410s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:39">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:39</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=20
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.414s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:40">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:40</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/product?productId=13
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.411s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.409s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href=/resources/labheader/css/academyLabHeader.css rel=stylesheet&gt;
        &lt;link href=/resources/css/labsEcommerce.css rel=stylesheet&gt;
        &lt;title&gt;Exploiting LLM APIs with excessive agency&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&#34;/resources/labheader/js/labHeader.js&#34;&gt;&lt;/script&gt;
        &lt;div id=&#34;academyLabHeader&#34;&gt;
            &lt;section class=&#39;academyLabBanner&#39;&gt;
                &lt;div class=container&gt;
                    &lt;div...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
        
        <div class="vuln-card low" data-severity="low" data-type="Security Misconfiguration" data-timestamp="2025-11-06 08:33:45">
            <div class="vuln-header">
                <div class="vuln-title">
                    üìå Security Misconfiguration
                </div>
                <span class="severity-badge badge-low">LOW</span>
            </div>
            
            <div class="meta-info">
                <div class="meta-item">
                    <strong>üåê URL</strong>
                    <span>https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js</span>
                </div>
                
                
                <div class="meta-item">
                    <strong>üïê Discovered</strong>
                    <span>2025-11-06 08:33:45</span>
                </div>
                
                
            </div>
            
            <div class="vuln-section">
                <h3>üìã Description</h3>
                <p>XSS protection header missing</p>
            </div>
            
            <div class="vuln-section">
                <h3>üîç Evidence</h3>
                <p>Missing header: X-XSS-Protection</p>
            </div>
            
            
            
            
            <div class="http-section">
                <h4>üì§ HTTP Request</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>GET https://0a390015043b86a5811a9d5f0068003f.web-security-academy.net/resources/labheader/js/labHeader.js
User-Agent: Deep-Eye/1.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Accept-Language: en-US,en;q=0.9
Cookie: [REDACTED]

</pre>
                </div>
                
                <h4 style="margin-top: 15px;">üì• HTTP Response</h4>
                <p><strong>Status:</strong> 200 | <strong>Latency:</strong> 0.400s</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>completedListeners = [];

(function () {
    let labHeaderWebSocket = undefined;
    function openWebSocket() {
        return new Promise(res =&gt; {
            if (labHeaderWebSocket) {
                res(labHeaderWebSocket);
                return;
            }

            let newWebSocket = new WebSocket(location.origin.replace(&#34;http&#34;, &#34;ws&#34;) + &#34;/academyLabHeader&#34;);

            newWebSocket.onopen = function (evt) {
                res(newWebSocket);
            };

           ...</pre>
                </div>
            </div>
            
            
            
            <div class="detection-source">
                <p><strong>üî¨ Detection Source - Where Vulnerability Was Detected in Scanner Code</strong></p>
                
                <p><strong>Module:</strong> core.vulnerability_scanner</p>
                
                
                <p><strong>Function:</strong> _check_security_headers</p>
                
                
                <p><strong>File:</strong> core/vulnerability_scanner.py (Lines 803-856)</p>
                
                
                
                <h4 style="margin-top: 15px;">üìù Detection Code (Lines 803-856)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                    <pre>    def _check_security_headers(self, url: str) -&gt; List[Dict]:
        &#34;&#34;&#34;Check for missing security headers with enhanced reporting.&#34;&#34;&#34;
        import time
        from core.vulnerability_helper import create_vulnerability
        
        vulnerabilities = []
        
        # Detection source information
        DETECTOR_LOCAL = {
            &#39;module&#39;: &#39;core.vulnerability_scanner&#39;,
            &#39;function&#39;: &#39;_check_security_headers&#39;,
            &#39;lines&#39;: (803, 856)
        }
        
        try:
            start_time = time.time()
            response = self.http_client.get(url)
            if not response:
                return vulnerabilities
            
            # Capture HTTP interaction details
            interaction = self.http_client.capture_interaction(
                response,
                start_time=start_time
            )
            
            headers = response.headers
            
            security_headers = {
                &#39;X-Frame-Options&#39;: (&#39;Clickjacking protection missing&#39;, &#39;medium&#39;),
                &#39;X-Content-Type-Options&#39;: (&#39;MIME sniffing protection missing&#39;, &#39;medium&#39;),
                &#39;Strict-Transport-Security&#39;: (&#39;HSTS not enforced&#39;, &#39;medium&#39;),
                &#39;Content-Security-Policy&#39;: (&#39;CSP not implemented&#39;, &#39;medium&#39;),
                &#39;X-XSS-Protection&#39;: (&#39;XSS protection header missing&#39;, &#39;low&#39;)
            }
            
            for header, (description, severity) in security_headers.items():
                if header not in headers:
                    # Payload information (header check context)
                    payload_info = {
                        &#39;payload&#39;: f&#39;Header check: {header}&#39;,
                        &#39;origin&#39;: {
                            &#39;file&#39;: &#39;core/vulnerability_scanner.py&#39;,
                            &#39;line&#39;: 814
                        },
                        &#39;parameter&#39;: header,
                        &#39;context&#39;: &#39;Security header presence validation&#39;
                    }
                    
                    # Generate vulnerable vs solution code examples

... [4 more lines]</pre>
                </div>
                
            </div>
            
            
            
            <div class="remediation-box">
                <h3>üîß Remediation</h3>
                <p><strong>Priority:</strong> <span class="severity-badge badge-medium">MEDIUM</span></p>
                <p><strong>Estimated Fix Time:</strong> 1-2 days</p>
                
                
                <h4 style="margin-top: 15px;">Steps to Fix:</h4>
                <ol>
                
                    <li>Add all missing security headers to HTTP responses</li>
                
                    <li>Configure Content-Security-Policy to prevent XSS attacks</li>
                
                    <li>Enable HTTP Strict Transport Security (HSTS)</li>
                
                    <li>Disable directory listings and unnecessary HTTP methods</li>
                
                    <li>Remove server version information from headers</li>
                
                    <li>Configure secure session cookies (Secure, HttpOnly, SameSite)</li>
                
                    <li>Disable debug mode and verbose errors in production</li>
                
                </ol>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - VULNERABLE
from flask import Flask

app = Flask(__name__)

# VULNERABLE: No security headers
@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;

# Missing: X-Frame-Options, CSP, HSTS, etc.</pre>
                        </div>
                    </div>
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Flask Application - SECURE
from flask import Flask

app = Flask(__name__)

@app.after_request
def add_security_headers(response):
    # SECURE: Add all security headers
    response.headers[&#39;X-Frame-Options&#39;] = &#39;DENY&#39;
    response.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    response.headers[&#39;X-XSS-Protection&#39;] = &#39;1; mode=block&#39;
    response.headers[&#39;Strict-Transport-Security&#39;] = &#39;max-age=31536000; includeSubDomains&#39;
    response.headers[&#39;Content-Security-Policy&#39;] = &#34;default-src &#39;self&#39;&#34;
    return response

@app.route(&#39;/&#39;)
def index():
    return &#34;&lt;h1&gt;Welcome&lt;/h1&gt;&#34;</pre>
                        </div>
                    </div>
                </div>
                
                
                
                <h4 style="margin-top: 15px;">üìö References:</h4>
                <ul>
                
                    <li>OWASP Security Headers Cheat Sheet</li>
                
                    <li>CWE-16: Configuration</li>
                
                    <li>https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html</li>
                
                    <li>https://securityheaders.com/</li>
                
                    <li>https://owasp.org/www-project-secure-headers/</li>
                
                </ul>
                
                
                
                <h4 style="margin-top: 20px;">üìä Code Comparison:</h4>
                <div class="code-comparison">
                    
                    <div class="vulnerable-code-block">
                        <h4>‚ùå Vulnerable Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - VULNERABLE
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# Missing X-XSS-Protection header
# No browser-level XSS protection</pre>
                        </div>
                    </div>
                    
                    
                    <div class="solution-code-block">
                        <h4>‚úÖ Solution Code</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
                            <pre># Apache .htaccess - SECURE
&lt;IfModule mod_headers.c&gt;
    Header set X-XSS-Protection &#34;1; mode=block&#34;
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;</pre>
                 